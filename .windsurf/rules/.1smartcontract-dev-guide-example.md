---
trigger: always_on
---


<example>
user: Create a secure NFT contract in Tact.  
assistant:  
1. **Stage 0**  
   - thinking: Check for existing NFT logic.  
     ```bash
     search_codebase "NFT contract"        # no matches
     ```  
   - thinking: Find best-practice NFT implementations.  
     ```bash
     search_web "TEP-62 secure NFT Tact"   # best-practice repo found
     ```  
   - thinking: Load Tact rules.  
     ```bash
     fetch_rules "tact"
     ```  

2. **Stage 1**  
   - thinking: Scaffold project.  
     ```bash
     npm -y create ton-ai@latest Nifty -- --type tact-empty --contractName SecureNFT
     cd Nifty
     ```  

3. **Stage 2**  
   - thinking: Build to verify baseline.  
     ```bash
     npx blueprint build --all   # ✅ build successful
     ```  

4. **Stage 3**  
   - thinking: Re-verify context.  
     ```bash
     search_codebase "SecureNFT"
     search_web "TEP-62 compliance tact"
     fetch_rules "tact"
     ```  

5. **Stage 4**  
   - thinking: Ensure wrappers exist and pass lint.  
     ```bash
     # low-level wrapper auto-generated
     npx eslint wrappers/**/*.ts --max-warnings 0  # ✅ 0 warnings
     ```  

6. **Stage 5**  
   - thinking: Run tests and observe failures.  
     ```bash
     npx blueprint test
     # ❌ fuzz test fails: replay-attack edge-case
     ```  
   - thinking: Deep research on replay protection.  
     ```bash
     search_codebase "nonce"         # finds outdated check
     search_web "replay protection tact contract"
     ```  
   - thinking: Fix contract, rebuild, re-run tests.  
     ```bash
     npx blueprint build --all
     npx blueprint test              # ✅ all tests pass
     ```  

7. **Stage 6**  
   - thinking: Deploy to Testnet and verify on-chain.  
     ```bash
     npx blueprint run deploy --testnet --tonconnect --tonviewer
     curl -s https://testnet.toncenter.com/api/v2/getAddressInformation?address=<ADDR> | jq '.result.state'  # "active"
     ```  

✅ **SecureNFT contract deployed and verified on-chain. Address: EQAbc123... Status: "active"**
</example>

<example>
user: Add jetton support to existing Func project **Vault**.  
assistant:  
1. **Stage 0**  
   - thinking: Locate the Vault project and check for jetton code.  
     ```bash
     search_codebase "Vault"          # finds project folder
     search_codebase "jetton"         # none
     ```  
   - thinking: Find official Jetton spec.  
     ```bash
     search_web "TEP-74 jetton func"
     fetch_rules "func"
     ```  

2. **Stage 1**  
   - thinking: Scaffold Jetton contract.  
     ```bash
     npm -y create ton-ai@latest VaultJetton -- --type func-empty --contractName SimpleJetton
     cd VaultJetton
     ```  

3. **Stage 2**  
   - thinking: Build and verify.  
     ```bash
     npx blueprint build --all        # ✅ build successful
     ```  

4. **Stage 3**  
   - thinking: Re-verify conformance.  
     ```bash
     search_codebase "SimpleJetton"
     search_web "TEP-74 func"
     ```  

5. **Stage 4**  
   - thinking: Create and lint wrapper.  
     ```bash
     npx eslint wrappers/**/*.ts --max-warnings 0  # ✅ 0 warnings
     ```  

6. **Stage 5**  
   - thinking: Run tests and address failures.  
     ```bash
     npx blueprint test
     # ❌ property test fails: supply overflow
     ```  
   - thinking: Investigate overflow issue.  
     ```bash
     search_codebase "total_supply"
     search_web "overflow check func int"
     ```  
   - thinking: Patch logic, rebuild, re-run tests.  
     ```bash
     npx blueprint build --all
     npx blueprint test              # ✅ all tests pass
     ```  

7. **Stage 6**  
   - thinking: Deploy to Testnet, verify state.  
     ```bash
     npx blueprint run deploy --testnet --tonconnect --tonviewer
     curl -s https://testnet.toncenter.com/api/v2/getAddressInformation?address=<ADDR> | jq '.result.state'  # "active"
     ```  

✅ **VaultJetton contract deployed and verified on-chain. Address: EQAxyz789... Status: "active"**
</example>